-#   Copyright (c) 2010, Diaspora Inc.  This file is
-#   licensed under the Affero General Public License version 3 or later.  See
-#   the COPYRIGHT file.


- content_for :head do
  :javascript
    $("#new_aspect").live("submit", function(){
      var newAspectName = $(this).children("#aspect_name").val();
      $("ul.aspects").prepend($("<li>" + newAspectName + "</li>").fadeIn(200));
      $("#aspect_nav").find("ul").first().find("li:last").before($("<li><a href='#'>" + newAspectName + "</a></li>").fadeIn(200));
    });

    $(".aspects li").find(".delete").live("click", function(){
      var aspectElement = $(this).parent("li");
      aspectElement.fadeOut(300, function(){aspectElement.remove();});
    });

.span-8.append-1.last{:style => "text-align:right;"}
  %h1
    = "Welcome to Diaspora!"
    .description
      Do the stuff below to further complete some things.

  %h3.nav
    = link_to "Edit your profile", getting_started_path(1)
    %br
    = link_to "Define your aspects", getting_started_path(2)
    %br
    = link_to "Connect your services", getting_started_path(3)
    %br

.span-15.last
  .floating
    %h3
      Your aspects
      .description
        Diaspora aspects are mappings of your real-life aspects.  You can manage these later by clicking the manage tab on the top right.  Your aspects are unique to you, and not visible by others.

    %h4
      Aspect name
      - form_for Aspect.new, :remote => true do |aspect|
        = aspect.text_field :name, :style => "display:inline;"
        = aspect.submit "Add"

    %ul.aspects
      - for aspect in @aspects
        %li{:style=>"position:relative;"}
          = aspect
          .friend_pictures.horizontal
            - for friend in aspect.people
              = person_image_link(friend)

            = link_to (image_tag('add_friend_button.png', :title => "add to #{aspect}")), "#add_request_pane", :class => 'add_request_button'

            .fancybox_content
              #add_request_pane
                = render "requests/new_request", :aspect => aspect, :getting_started => 2

          = link_to "x", aspect_path(aspect), :confirm => "are you sure?", :method => :delete, :remote => true, :class => "delete right"

    %br
    %br

    .submit_block
      = link_to "Back", getting_started_path(1), :class => "button"
      = link_to "Save and continue →", getting_started_path(3), :class => "button"


.bottom_notification
  = link_to "skip getting started →", '#'
